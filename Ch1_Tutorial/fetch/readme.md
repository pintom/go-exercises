This code is from section 1.5